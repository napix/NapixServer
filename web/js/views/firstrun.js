/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */

/* ===================================================
 * bootstrap-transition.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#transitions
 * ===================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */

/* ==========================================================
 * bootstrap-alert.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#alerts
 * ==========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */

/* ============================================================
 * bootstrap-button.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#buttons
 * ============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */

/* ==========================================================
 * bootstrap-carousel.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#carousel
 * ==========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */

/* =============================================================
 * bootstrap-collapse.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#collapse
 * =============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */

/* ============================================================
 * bootstrap-dropdown.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#dropdowns
 * ============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */

/* =========================================================
 * bootstrap-modal.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#modals
 * =========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================= */

/* ===========================================================
 * bootstrap-tooltip.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#tooltips
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ===========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */

/* ===========================================================
 * bootstrap-popover.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#popovers
 * ===========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =========================================================== */

/* =============================================================
 * bootstrap-scrollspy.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#scrollspy
 * =============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================== */

/* ========================================================
 * bootstrap-tab.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#tabs
 * ========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================== */

/* =============================================================
 * bootstrap-typeahead.js v2.0.4
 * http://twitter.github.com/bootstrap/javascript.html#typeahead
 * =============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */

define("libs/mustache",[],function(){var e=typeof module!="undefined"&&module.exports||{};return function(e){function a(e){return u.test(e)}function p(e){return String(e).replace(/&(?!\w+;)|[<>"']/g,function(e){return h[e]||e})}function d(e,t,n,r){r=r||"<template>";var i=t.split("\n"),s=Math.max(n-3,0),o=Math.min(i.length,n+3),u=i.slice(s,o),a;for(var f=0,l=u.length;f<l;++f)a=f+s+1,u[f]=(a===n?" >> ":"    ")+u[f];return e.template=t,e.line=n,e.file=r,e.message=[r+":"+n,u.join("\n"),"",e.message].join("\n"),e}function v(e,t,n){if(e===".")return t[t.length-1];var r=e.split("."),i=r.length-1,s=r[i],o,u,a=t.length,f,l;while(a){l=t.slice(0),u=t[--a],f=0;while(f<i){u=u[r[f++]];if(u==null)break;l.push(u)}if(u&&typeof u=="object"&&s in u){o=u[s];break}}return typeof o=="function"&&(o=o.call(l[l.length-1])),o==null?n:o}function m(e,t,n,r){var i="",u=v(e,t);if(r){if(u==null||u===!1||s(u)&&u.length===0)i+=n()}else if(s(u))o(u,function(e){t.push(e),i+=n(),t.pop()});else if(typeof u=="object")t.push(u),i+=n(),t.pop();else if(typeof u=="function"){var a=t[t.length-1],f=function(e){return S(e,a)};i+=u.call(a,n(),f)||""}else u&&(i+=n());return i}function g(t,n){n=n||{};var r=n.tags||e.tags,i=r[0],s=r[r.length-1],o=['var buffer = "";',"\nvar line = 1;","\ntry {",'\nbuffer += "'],u=[],l=!1,c=!1,h=function(){if(l&&!c&&!n.space)while(u.length)o.splice(u.pop(),1);else u=[];l=!1,c=!1},p=[],v,m,g,y=function(e){r=f(e).split(/\s+/),m=r[0],g=r[r.length-1]},b=function(e){o.push('";',v,'\nvar partial = partials["'+f(e)+'"];',"\nif (partial) {","\n  buffer += render(partial,stack[stack.length - 1],partials);","\n}",'\nbuffer += "')},w=function(e,r){var i=f(e);if(i==="")throw d(new Error("Section name may not be empty"),t,N,n.file);p.push({name:i,inverted:r}),o.push('";',v,'\nvar name = "'+i+'";',"\nvar callback = (function () {","\n  return function () {",'\n    var buffer = "";','\nbuffer += "')},E=function(e){w(e,!0)},S=function(e){var r=f(e),i=p.length!=0&&p[p.length-1].name;if(!i||r!=i)throw d(new Error('Section named "'+r+'" was never opened'),t,N,n.file);var s=p.pop();o.push('";',"\n    return buffer;","\n  };","\n})();"),s.inverted?o.push("\nbuffer += renderSection(name,stack,callback,true);"):o.push("\nbuffer += renderSection(name,stack,callback);"),o.push('\nbuffer += "')},x=function(e){o.push('";',v,'\nbuffer += lookup("'+f(e)+'",stack,"");','\nbuffer += "')},T=function(e){o.push('";',v,'\nbuffer += escapeHTML(lookup("'+f(e)+'",stack,""));','\nbuffer += "')},N=1,C,k;for(var L=0,A=t.length;L<A;++L)if(t.slice(L,L+i.length)===i){L+=i.length,C=t.substr(L,1),v="\nline = "+N+";",m=i,g=s,l=!0;switch(C){case"!":L++,k=null;break;case"=":L++,s="="+s,k=y;break;case">":L++,k=b;break;case"#":L++,k=w;break;case"^":L++,k=E;break;case"/":L++,k=S;break;case"{":s="}"+s;case"&":L++,c=!0,k=x;break;default:c=!0,k=T}var O=t.indexOf(s,L);if(O===-1)throw d(new Error('Tag "'+i+'" was not closed properly'),t,N,n.file);var M=t.substring(L,O);k&&k(M);var _=0;while(~(_=M.indexOf("\n",_)))N++,_++;L=O+s.length-1,i=m,s=g}else{C=t.substr(L,1);switch(C){case'"':case"\\":c=!0,o.push("\\"+C);break;case"\r":break;case"\n":u.push(o.length),o.push("\\n"),h(),N++;break;default:a(C)?u.push(o.length):c=!0,o.push(C)}}if(p.length!=0)throw d(new Error('Section "'+p[p.length-1].name+'" was not closed properly'),t,N,n.file);h(),o.push('";',"\nreturn buffer;","\n} catch (e) { throw {error: e, line: line}; }");var D=o.join("").replace(/buffer \+= "";\n/g,"");return n.debug&&(typeof console!="undefined"&&console.log?console.log(D):typeof print=="function"&&print(D)),D}function y(e,t){var n="view,partials,stack,lookup,escapeHTML,renderSection,render",r=g(e,t),i=new Function(n,r);return function(n,r){r=r||{};var s=[n];try{return i(n,r,s,v,p,m,S)}catch(o){throw d(o.error,e,o.line,t.file)}}}function w(){b={}}function E(e,t){return t=t||{},t.cache!==!1?(b[e]||(b[e]=y(e,t)),b[e]):y(e,t)}function S(e,t,n){return E(e)(t,n)}e.name="mustache.js",e.version="0.5.0-dev",e.tags=["{{","}}"],e.parse=g,e.compile=E,e.render=S,e.clearCache=w,e.to_html=function(e,t,n,r){var i=S(e,t,n);if(typeof r!="function")return i;r(i)};var t=Object.prototype.toString,n=Array.isArray,r=Array.prototype.forEach,i=String.prototype.trim,s;n?s=n:s=function(e){return t.call(e)==="[object Array]"};var o;r?o=function(e,t,n){return r.call(e,t,n)}:o=function(e,t,n){for(var r=0,i=e.length;r<i;++r)t.call(n,e[r],r,e)};var u=/^\s*$/,f;if(i)f=function(e){return e==null?"":i.call(e)};else{var l,c;a("Â ")?(l=/^\s+/,c=/\s+$/):(l=/^[\s\xA0]+/,c=/[\s\xA0]+$/),f=function(e){return e==null?"":String(e).replace(l,"").replace(c,"")}}var h={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},b={}}(e),e}),define("libs/deferred",["jQuery","underscore"],function(e,t){var n=function(e,t){this._orig=e,this._deferred=e._deferred.pipe.apply(e._deferred,t)};n.prototype={state:function(){return this._orig.state()},fire:function(){return this._orig.fire(),this},pipe:function(){return new n(this,arguments)}};var r=function(t){t?(this.firefn=t,this.fired=!1):this.fired=!0,this._deferred=(new e.Deferred).always(function(){this.fired=!0}.bind(this))};return r.when=e.when,r.prototype={state:function(){return this.fired?this._deferred.state():"new"},fire:function(){return this.fired||(this.fired=!0,this.firefn(this)),this},pipe:function(){return new n(this,arguments)}},t.each("promise".split(" "),function(e){r.prototype[e]=n.prototype[e]=function(){return this._deferred[e].apply(this._deferred,arguments)}}),t.each("resolve reject done then fail always".split(" "),function(e){r.prototype[e]=n.prototype[e]=function(){return this._deferred[e].apply(this._deferred,arguments),this}}),r}),define("underscore-extensions",["underscore"],function(e){e.mixin({objectify:function(t){return e.reduce(t,function(e,t){return e[t[0]]=t[1],e},{})},items:function(t){return e.map(t,function(e,t){return{val:e,key:t}})}})}),define("views/explorer/path",["Backbone","underscore","jQuery","libs/mustache","client/full","libs/deferred","underscore-extensions"],function(e,t,n,r,i,s,o){var u=e.View.extend({tagName:"div",events:{"click a.path":"select"},_initDefered:function(e){e=e||{all:!0},e.all&&(this.metaData=(new s(function(e){i.getLevel(this.path,e.resolve.bind(e))}.bind(this))).done(this.addPlus.bind(this)));if(e.all||e.content)this.contentViews=(new s(this.getList.bind(this))).fail(this.failed.bind(this)),this.pathList=this.contentViews.pipe(function(e){return t.pluck(e,"decodedPath")});if(e.all||e.object)this.object=new s(function(e){i.GET(this.path,e.resolve.bind(e),e.reject.bind(e))}.bind(this)),this.parentMetaData?this.object.fail(this.failed.bind(this)):this.object.reject("here")},initialize:function(e,n){this.path=e,this.decodedPath=decodeURIComponent(e),this.parentMetaData=n,this._initDefered(),n&&t.isNull(n.direct_plug)?(this.metaData.reject(),this.contentViews.reject()):n&&n.direct_plug===!1?t.defer(this.metaData.resolve.bind(this.metaData),null):this.metaData.fire()},template:r.compile('<div class="explorer-header"><a class="path" href="{{path}}" >{{ decodedPath }}</a></div>'),render:function(){return this.$el.append(this.template(this)),this},failed:function(e,t,r){if(!e)return;this.$(".path").append(n("<i />",{"class":"icon-exclamation-sign"}).popover({title:e,content:r&&r.responseText,placement:"right"})).addClass("failed")},resize:function(){var e=null;while(this.$(".explorer-header").width()<this.$("a").width()){e=e||t.map(this.path.split("/"),decodeURIComponent),e.shift(),this.$(".path").first().text(".../"+e.join("/"));if(e.length===1)break}},addPlus:function(){n("<div />",{"class":"explorer-content"}).appendTo(this.el),n("<i />",{"class":"deploy icon-plus"}).prependTo(this.$(".explorer-header").first()).click(this.toggleList.bind(this))},triggerSelect:function(){this.trigger("select",this)},refire:function(e){this.trigger("select",e)},setSelected:function(e){this.$(".explorer-header").first().removeClass("pending").toggleClass("selected",e)},getList:function(e){var n=i.GET(this.path+"/").fail(e.reject.bind(e));s.when(n.pipe(t.identity),this.metaData.pipe(t.identity)).done(this.gotList.bind(this))},gotList:function(e,n){var r=this.$(".explorer-content").first().empty();this.$(".deploy").first().addClass("icon-minus");var i=t.chain(e).filter(function(e){return e.search("/_napix")===-1}).sortBy(t.identity).map(function(e){var t=new u(e,n);return t.bind("select",this.refire,this),r.append(t.render().el),t.resize(),t},this).map(function(e){return[e.path,e]}).objectify().value();this.contentViews.resolve(i)},select:function(){var e;return this.$(".explorer-header").first().addClass("pending"),this.object.state()==="rejected"?e=this.pathList:e=this.object,e.state()==="pending"?!1:(e.done(function(e){this.content=e,this.triggerSelect()}.bind(this)).fire(),!1)},toggleList:function(e){if(!this.filled)this.filled=!0,this.contentViews.fire();else if(t.isBoolean(e))this.$(".explorer-content").first().toggle(e),this.$(".deploy").first().addClass(e?"icon-plus":"icon-minus");else{var n=this.$(".explorer-content").first().toggle().css("display")==="none";this.$(".deploy").first().addClass(n?"icon-plus":"icon-minus").removeClass(n?"icon-minus":"icon-plus")}return!1},refreshObject:function(){this._initDefered({object:!0}),this.select()},refreshList:function(){if(this.metaData.state()==="rejected")return;this._initDefered({content:!0}),this.filled=!1,this.toggleList()},goToPath:function(e,n){this.path===e?(this.select(),n.resolve(this)):e.search(this.path)===0&&(this.metaData.done(this.toggleList.bind(this,!0)),this.contentViews.done(function(r){t.any(r,function(t,r){return e===r||e.search(r+"/")===0?(t.goToPath(e,n),!0):!1})||(this.select(),n.reject(this))}.bind(this)))}});return u}),define("views/explorer/root",["Backbone","underscore","client/full","views/explorer/path","underscore-extensions","deferred","libs/mustache"],function(e,t,n,r,i,s,o){var u=e.View.extend({id:"explorer-root",events:{"click .slash":"deploy"},initialize:function(){this.list=new s,this.connecting=!1},goToPath:function(e,n){this.deploy(),this.list.done(function(r){t.any(r,function(t,r){return e.search(r)===0?(t.goToPath(e,n),!0):!1})||n.reject()})},deploy:function(){return!this.connecting&&this.list.state()!=="resolved"?(this.connecting=!0,this.$el.empty().text("Connecting"),n.request({method:"GET",uri:"/"},{failSilently:!0}).always(function(){this.connecting=!1}.bind(this)).then(this.gotList.bind(this),this.failedToGetList.bind(this))):this.list.state()==="rejected"&&(this.list=new s,this.deploy()),!1},failedTemplate:o.compile('<p>Failed to connect: <span class="text-error">{{ error }}</span></p><p><small>{{ cause }}; <a href="#retry" class="slash" >click here</a> to retry</small></p>'),failedCauses:{forbidden:function(){return"Check the login and the password"},unauthorized:function(){var e=require("models/credentials").selected();return e===null?"Login using the login selector on the right":e.get("pass")==="_napix_noauth"?"You are using the anonymous authentication and the destination server does not support it":"Verify that the server is actually a Napix server"},timeout:function(){return"Verify that the server is alive"},error:function(){return"unknown error"},"internal server error":function(e){return e.responseText}},failedToGetList:function(e,t,n){var r=this.failedCauses[(e||n.statusText).toLowerCase()];this.$el.empty().append(this.failedTemplate({cause:r&&r(n)||"Check the credentials and the server",error:e||n.statusText})),this.list.reject(e)},gotList:function(e){this.$el.empty().append('<div class="slash" ></div> <div class="explorer-content" />');var n=this.$(".explorer-content");this.views=t(e).chain().map(function(e){var t=new r(e);return t.bind("select",this.refire,this),n.append(t.render().el),t},this).map(function(e){return[e.path,e]}).objectify().value(),this.list.resolve(this.views)},refire:function(e){this.trigger("select",e)}});return u}),define("views/json/multitype",["Backbone","libs/mustache"],function(e,t){var n=e.View.extend({tagName:"div",className:"json-multiedit",initialize:function(e){this.finder=e.finder,this.view=e.view,this.poppable=!!e.poppable,this.changeable=!!e.changeable},template:t.compile('<div class="json-mte btn-group">{{^changeable}}<button class="btn btn-mini disabled">{{ datatype }}</button>{{/changeable}}{{#changeable}}<button class="btn btn-mini" tabindex="3" data-type="null" >null</button><button class="btn btn-mini" tabindex="3" data-type="boolean" >bool</button><button class="btn btn-mini" tabindex="3" data-type="string" >abc</button><button class="btn btn-mini" tabindex="3" data-type="number" >123</button><button class="btn btn-mini" tabindex="3" data-type="array" >[ ]</button><button class="btn btn-mini" tabindex="3" data-type="object" >{ }</button>{{/changeable}}{{#poppable}}<button class="btn btn-mini btn-danger" tabindex="3" data-type="pop" >X</button/>{{/poppable}}</div>'),events:{"click button[data-type][data-type!='pop']":"onTranspose","click button[data-type='pop']":"pop"},render:function(){return this.$el.append(this.template({poppable:this.poppable,changeable:this.changeable,datatype:this.view.dataType})),this.$("[data-type='"+this.view.dataType+"']").addClass("active"),this.$el.append(this.view.render().el),this},getValue:function(){return this.view.getValue()},onTranspose:function(e){return this.transpose(e.target.dataset.type),this.$(":input").not(".btn").first().focus(),!1},transpose:function(e){var t=this.finder.getViewClassByType(e);this.view=new t({value:this.view.getValue(),originalValue:this.view.originalValue,finder:this.finder}),this.$el.empty(),this.render()},pop:function(){return this.trigger("pop",this),!1}});return n}),define("views/json/finder",["underscore","views/json/multitype"],function(e,t){var n=function(e){this.viewsMap=e.views};n.prototype={getViewClass:function(t){return e.find(this.viewsMap,function(e){return e.detect(t)})},getView:function(e){var t=this.getViewClass(e);return new t({value:e,finder:this})}};var r=function(e){return n.call(this,e),this.fixedViewsMap=e.fixedViews||[],this.typesMap=e.typesMap||{},this};return e.extend(r.prototype,n.prototype,{getView:function(n,r,i){var s,o=!0,u="";e.isUndefined(n)&&e.isUndefined(r)&&(n=""),e.isString(r)&&(o=r.indexOf(";optional")!==-1,u=r.split(";").shift());var a=!0;e.isArray(r)||e.isObject(r)?(s=this.getFixedViewClass(r),a=!1):e.isString(r)&&u?s=this.getViewClassByType.call(this,u):s=this.getViewClass(n);var f=new s({value:n,originalValue:e.isUndefined(i)?n:i,types:r,finder:this});return a?new t({finder:this,view:f,poppable:o,changeable:u===""}):f},getDefaultViewClass:function(){return this.getViewClassByType("default")},getFixedViewClass:function(t){return e.find(this.fixedViewsMap,function(e){return e.detect(t)})},getViewClassByType:function(t){return t=this.typesMap[t]||t,e.find(this.viewsMap,function(e){return e.prototype.dataType===t})}}),{viewer:n,editor:r}}),define("views/json/viewer",["Backbone","underscore","jQuery","views/json/finder"],function(e,t,n,r){var i=e.View.extend({tagName:"span",className:"json-simple",complex:!1,initialize:function(e){this.value=String(e.value)},render:function(){return this.$el.text(this.value),this}},{detect:function(e){return t.isBoolean(e)||t.isNumber(e)}}),s=i.extend({tagName:"span",initialize:function(e){s.__super__.initialize.call(this,e),this.value.indexOf("\n")!==-1&&this.setElement(this.make("p",{"class":this.className}))},render:function(){return this.$el.append(t.escape(this.value).replace(/\n/g,"<br />")),this}},{detect:t.isString}),o=i.extend({initialize:function(e){this.value="?",t.any([[t.isNull,"null"],[t.isString,"Empty String"],[t.isArray,"Empty Array"],[t.bind(t.identity,t,!0),"Empty Object"]],function(t){return t[0](e.value)?(this.value=t[1],!0):!1},this)}},{detect:function(e){return t.isNull(e)||t.isEmpty(e)}}),u=e.View.extend({tagName:"ol",complex:!0,initialize:function(e){this.listViews=t.map(e.value,function(t){return e.finder.getView(t)})},render:function(){return t.each(this.listViews,function(e){n("<li />").append(e.render().el).appendTo(this.el)},this),this}},{detect:t.isArray}),a=e.View.extend({complex:!1,tagName:"li",initialize:function(e,t){this.key=e,this.valueView=t},render:function(){return this.valueView.complex?n("<dd />").append(n("<dl />",{"class":"json-key",text:this.key})).append(n("<dt />").append(this.valueView.render().el)).appendTo(this.el):n("<div />").append(n("<span />",{"class":"json-key",text:this.key})).append(" ").append(this.valueView.render().el).appendTo(this.el),this}}),f=e.View.extend({tagName:"ul",complex:!0,initialize:function(e){var n=e.finder;this.keyViews=t.map(t.keys(e.value),function(t){return new a(t,n.getView(e.value[t]))})},render:function(){return t.each(this.keyViews,function(e){this.$el.append(e.render().el)},this),this}},{detect:t.isObject}),l=e.View.extend({className:"json-object json",tagName:"div",finder:new r.viewer({views:[i,o,s,u,f]}),initialize:function(e){this.inside=this.finder.getView(e.value)},render:function(){return this.$el.append(this.inside.render().el),this}});return l}),define("views/explorer/alert",["Backbone","underscore","jQuery","libs/mustache","client/full","views/json/viewer"],function(e,t,n,r,i,s){var o=e.View.extend({template:r.compile('<div class="alert alert-block alert-{{level}}"><a href="#" class="close" data-dismiss="alert">X</a><h4 class="alert-heading">{{ text }}</h4>{{#location}}<p> Path : <a href="#{{location}}">{{location}}</a> </p>{{/location}}{{#retry}} <button id="{{alertId}}" class="btn retry btn-primary">Retry</button>{{/retry}}<div id="{{alertId}}" class="accordion-group"> <a class="accordion-heading" data-toggle="collapse"data-target="#{{alertId}}-request" data-parent="#{{alertId}}" >Request Data</a><div id="{{alertId}}-request" class="accordion-body collapse"><div class="pre" ><strong>{{request.method}}</strong> {{request.host}} <a href="{{request.uri}}">{{request.uri}}</a> </div>{{#request.data}}<div class="pre" ><div id="{{alertId}}-object" ></div> </div>{{/request.data}}</div><a class="accordion-heading" data-toggle="collapse"data-target="#{{alertId}}-response" data-parent="#{{alertId}}" >Response Data</a><div id="{{alertId}}-response" class="accordion-body collapse"><p class="pre" ><strong>{{ response.status }}</strong> {{ response.statusText}}</p><pre>{{response.headers}}</pre></div></div></div>'),events:{"click .retry":"retry"},initialize:function(){this.setElement("#explorer-alerts"),this.currentAlert=null,this.currentRequest=null},retry:function(){i.request(this.currentRequest),this._close(500)},_alert:function(e,r,i,o){this.currentRequest=r;var u=t.extend(o,{text:e,alertId:t.uniqueId("alert-"),request:r,response:{headers:i.getAllResponseHeaders(),status:i.status,statusText:i.statusText}}),a=n(this.template(u));return r.data!==null&&a.find("#"+u.alertId+"-object").replaceWith((new s({value:r.data})).render().el),this._append(a)},done:function(e,t,n){var r=n.getResponseHeader("Location");this._alert(e,t,n,{level:"success",location:r&&decodeURIComponent(r)})},failed:function(e,r,i){var o=null;e?e.jquery?(o=e,e="An error occurred"):t.isObject(e)&&(o=(new s({value:e})).render().el,e="An error occurred"):(e="Unknown error",o="If you use the Napix web interface to connect to another host you can not see the content of errors");var u=this._alert(e,r,i,{level:"danger",retry:!0});o&&n(u).find("h4.alert-heading:first").after(n("<div />",{"class":"pre"}).append(o))},_close:function(e){if(this.currentAlert){var r=n(this.currentAlert).addClass("fade").addClass("in").addClass("alert-info").removeClass("alert-danger").removeClass("alert-success");t.delay(t.bind(r.alert,r,"close"),e||1500)}},_append:function(e){return this._close(),this.$el.prepend(e),this.currentAlert=e,e}});return o}),!function(e){e(function(){e.support.transition=function(){var e=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},n;for(n in t)if(e.style[n]!==undefined)return t[n]}();return e&&{end:e}}()})}(window.jQuery),!function(e){var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function s(){i.trigger("closed").remove()}var n=e(this),r=n.attr("data-target"),i;r||(r=n.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,"")),i=e(r),t&&t.preventDefault(),i.length||(i=n.hasClass("alert")?n:n.parent()),i.trigger(t=e.Event("close"));if(t.isDefaultPrevented())return;i.removeClass("in"),e.support.transition&&i.hasClass("fade")?i.on(e.support.transition.end,s):s()},e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data("alert");i||r.data("alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.alert.Constructor=n,e(function(){e("body").on("click.alert.data-api",t,n.prototype.close)})}(window.jQuery),!function(e){var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.button.defaults,n)};t.prototype.setState=function(e){var t="disabled",n=this.$element,r=n.data(),i=n.is("input")?"val":"html";e+="Text",r.resetText||n.data("resetText",n[i]()),n[i](r[e]||this.options[e]),setTimeout(function(){e=="loadingText"?n.addClass(t).attr(t,t):n.removeClass(t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.parent('[data-toggle="buttons-radio"]');e&&e.find(".active").removeClass("active"),this.$element.toggleClass("active")},e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data("button"),s=typeof n=="object"&&n;i||r.data("button",i=new t(this,s)),n=="toggle"?i.toggle():n&&i.setState(n)})},e.fn.button.defaults={loadingText:"loading..."},e.fn.button.Constructor=t,e(function(){e("body").on("click.button.data-api","[data-toggle^=button]",function(t){var n=e(t.target);n.hasClass("btn")||(n=n.closest(".btn")),n.button("toggle")})})}(window.jQuery),!function(e){var t=function(t,n){this.$element=e(t),this.options=n,this.options.slide&&this.slide(this.options.slide),this.options.pause=="hover"&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};t.prototype={cycle:function(t){return t||(this.paused=!1),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},to:function(t){var n=this.$element.find(".active"),r=n.parent().children(),i=r.index(n),s=this;if(t>r.length-1||t<0)return;return this.sliding?this.$element.one("slid",function(){s.to(t)}):i==t?this.pause().cycle():this.slide(t>i?"next":"prev",e(r[t]))},pause:function(e){return e||(this.paused=!0),clearInterval(this.interval),this.interval=null,this},next:function(){if(this.sliding)return;return this.slide("next")},prev:function(){if(this.sliding)return;return this.slide("prev")},slide:function(t,n){var r=this.$element.find(".active"),i=n||r[t](),s=this.interval,o=t=="next"?"left":"right",u=t=="next"?"first":"last",a=this,f=e.Event("slide");this.sliding=!0,s&&this.pause(),i=i.length?i:this.$element.find(".item")[u]();if(i.hasClass("active"))return;if(e.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(f);if(f.isDefaultPrevented())return;i.addClass(t),i[0].offsetWidth,r.addClass(o),i.addClass(o),this.$element.one(e.support.transition.end,function(){i.removeClass([t,o].join(" ")).addClass("active"),r.removeClass(["active",o].join(" ")),a.sliding=!1,setTimeout(function(){a.$element.trigger("slid")},0)})}else{this.$element.trigger(f);if(f.isDefaultPrevented())return;r.removeClass("active"),i.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return s&&this.cycle(),this}},e.fn.carousel=function(n){return this.each(function(){var r=e(this),i=r.data("carousel"),s=e.extend({},e.fn.carousel.defaults,typeof n=="object"&&n);i||r.data("carousel",i=new t(this,s)),typeof n=="number"?i.to(n):typeof n=="string"||(n=s.slide)?i[n]():s.interval&&i.cycle()})},e.fn.carousel.defaults={interval:5e3,pause:"hover"},e.fn.carousel.Constructor=t,e(function(){e("body").on("click.carousel.data-api","[data-slide]",function(t){var n=e(this),r,i=e(n.attr("data-target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")),s=!i.data("modal")&&e.extend({},i.data(),n.data());i.carousel(s),t.preventDefault()})})}(window.jQuery),!function(e){var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.collapse.defaults,n),this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.prototype={constructor:t,dimension:function(){var e=this.$element.hasClass("width");return e?"width":"height"},show:function(){var t,n,r,i;if(this.transitioning)return;t=this.dimension(),n=e.camelCase(["scroll",t].join("-")),r=this.$parent&&this.$parent.find("> .accordion-group > .in");if(r&&r.length){i=r.data("collapse");if(i&&i.transitioning)return;r.collapse("hide"),i||r.data("collapse",null)}this.$element[t](0),this.transition("addClass",e.Event("show"),"shown"),this.$element[t](this.$element[0][n])},hide:function(){var t;if(this.transitioning)return;t=this.dimension(),this.reset(this.$element[t]()),this.transition("removeClass",e.Event("hide"),"hidden"),this.$element[t](0)},reset:function(e){var t=this.dimension();return this.$element.removeClass("collapse")[t](e||"auto")[0].offsetWidth,this.$element[e!==null?"addClass":"removeClass"]("collapse"),this},transition:function(t,n,r){var i=this,s=function(){n.type=="show"&&i.reset(),i.transitioning=0,i.$element.trigger(r)};this.$element.trigger(n);if(n.isDefaultPrevented())return;this.transitioning=1,this.$element[t]("in"),e.support.transition&&this.$element.hasClass("collapse")?this.$element.one(e.support.transition.end,s):s()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}},e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("collapse"),s=typeof n=="object"&&n;i||r.data("collapse",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.collapse.defaults={toggle:!0},e.fn.collapse.Constructor=t,e(function(){e("body").on("click.collapse.data-api","[data-toggle=collapse]",function(t){var n=e(this),r,i=n.attr("data-target")||t.preventDefault()||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),s=e(i).data("collapse")?"toggle":n.data();e(i).collapse(s)})})}(window.jQuery),!function(e){function r(){e(t).parent().removeClass("open")}var t='[data-toggle="dropdown"]',n=function(t){var n=e(t).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){n.parent().removeClass("open")})};n.prototype={constructor:n,toggle:function(t){var n=e(this),i,s,o;if(n.is(".disabled, :disabled"))return;return s=n.attr("data-target"),s||(s=n.attr("href"),s=s&&s.replace(/.*(?=#[^\s]*$)/,"")),i=e(s),i.length||(i=n.parent()),o=i.hasClass("open"),r(),o||i.toggleClass("open"),!1}},e.fn.dropdown=function(t){return this.each(function(){var r=e(this),i=r.data("dropdown");i||r.data("dropdown",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.dropdown.Constructor=n,e(function(){e("html").on("click.dropdown.data-api",r),e("body").on("click.dropdown",".dropdown form",function(e){e.stopPropagation()}).on("click.dropdown.data-api",t,n.prototype.toggle)})}(window.jQuery),!function(e){function n(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end),r.call(t)},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n),r.call(t)})}function r(e){this.$element.hide().trigger("hidden"),i.call(this)}function i(t){var n=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class="modal-backdrop '+r+'" />').appendTo(document.body),this.options.backdrop!="static"&&this.$backdrop.click(e.proxy(this.hide,this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),i?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,e.proxy(s,this)):s.call(this)):t&&t()}function s(){this.$backdrop.remove(),this.$backdrop=null}function o(){var t=this;this.isShown&&this.options.keyboard?e(document).on("keyup.dismiss.modal",function(e){e.which==27&&t.hide()}):this.isShown||e(document).off("keyup.dismiss.modal")}var t=function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this))};t.prototype={constructor:t,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=e.Event("show");this.$element.trigger(n);if(this.isShown||n.isDefaultPrevented())return;e("body").addClass("modal-open"),this.isShown=!0,o.call(this),i.call(this,function(){var n=e.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),n&&t.$element[0].offsetWidth,t.$element.addClass("in"),n?t.$element.one(e.support.transition.end,function(){t.$element.trigger("shown")}):t.$element.trigger("shown")})},hide:function(t){t&&t.preventDefault();var i=this;t=e.Event("hide"),this.$element.trigger(t);if(!this.isShown||t.isDefaultPrevented())return;this.isShown=!1,e("body").removeClass("modal-open"),o.call(this),this.$element.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?n.call(this):r.call(this)}},e.fn.modal=function(n){return this.each(function(){var r=e(this),i=r.data("modal"),s=e.extend({},e.fn.modal.defaults,r.data(),typeof n=="object"&&n);i||r.data("modal",i=new t(this,s)),typeof n=="string"?i[n]():s.show&&i.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},e.fn.modal.Constructor=t,e(function(){e("body").on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),r,i=e(n.attr("data-target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({},i.data(),n.data());t.preventDefault(),i.modal(s)})})}(window.jQuery),!function(e){var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,n,r){var i,s;this.type=t,this.$element=e(n),this.options=this.getOptions(r),this.enabled=!0,this.options.trigger!="manual"&&(i=this.options.trigger=="hover"?"mouseenter":"focus",s=this.options.trigger=="hover"?"mouseleave":"blur",this.$element.on(i,this.options.selector,e.proxy(this.enter,this)),this.$element.on(s,this.options.selector,e.proxy(this.leave,this))),this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=e.extend({},e.fn[this.type].defaults,t,this.$element.data()),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);if(!n.options.delay||!n.options.delay.show)return n.show();clearTimeout(this.timeout),n.hoverState="in",this.timeout=setTimeout(function(){n.hoverState=="in"&&n.show()},n.options.delay.show)},leave:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);this.timeout&&clearTimeout(this.timeout);if(!n.options.delay||!n.options.delay.hide)return n.hide();n.hoverState="out",this.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},show:function(){var e,t,n,r,i,s,o;if(this.hasContent()&&this.enabled){e=this.tip(),this.setContent(),this.options.animation&&e.addClass("fade"),s=typeof this.options.placement=="function"?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,t=/in/.test(s),e.remove().css({top:0,left:0,display:"block"}).appendTo(t?this.$element:document.body),n=this.getPosition(t),r=e[0].offsetWidth,i=e[0].offsetHeight;switch(t?s.split(" ")[1]:s){case"bottom":o={top:n.top+n.height,left:n.left+n.width/2-r/2};break;case"top":o={top:n.top-i,left:n.left+n.width/2-r/2};break;case"left":o={top:n.top+n.height/2-i/2,left:n.left-r};break;case"right":o={top:n.top+n.height/2-i/2,left:n.left+n.width}}e.css(o).addClass(s).addClass("in")}},isHTML:function(e){return typeof e!="string"||e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3||/^(?:[^<]*<[\w\W]+>[^>]*$)/.exec(e)},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.isHTML(t)?"html":"text"](t),e.removeClass("fade in top bottom left right")},hide:function(){function r(){var t=setTimeout(function(){n.off(e.support.transition.end).remove()},500);n.one(e.support.transition.end,function(){clearTimeout(t),n.remove()})}var t=this,n=this.tip();n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?r():n.remove()},fixTitle:function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(t){return e.extend({},t?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},tip:function(){return this.$tip=this.$tip||e(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()}},e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("tooltip"),s=typeof n=="object"&&n;i||r.data("tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0}}(window.jQuery),!function(e){var t=function(e,t){this.init("popover",e,t)};t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype,{constructor:t,setContent:function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.isHTML(t)?"html":"text"](t),e.find(".popover-content > *")[this.isHTML(n)?"html":"text"](n),e.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-content")||(typeof n.content=="function"?n.content.call(t[0]):n.content),e},tip:function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip}}),e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("popover"),s=typeof n=="object"&&n;i||r.data("popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.defaults=e.extend({},e.fn.tooltip.defaults,{placement:"right",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}(window.jQuery),!function(e){function t(t,n){var r=e.proxy(this.process,this),i=e(t).is("body")?e(window):e(t),s;this.options=e.extend({},e.fn.scrollspy.defaults,n),this.$scrollElement=i.on("scroll.scroll.data-api",r),this.selector=(this.options.target||(s=e(t).attr("href"))&&s.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.$body=e("body"),this.refresh(),this.process()}t.prototype={constructor:t,refresh:function(){var t=this,n;this.offsets=e([]),this.targets=e([]),n=this.$body.find(this.selector).map(function(){var t=e(this),n=t.data("target")||t.attr("href"),r=/^#\w/.test(n)&&e(n);return r&&n.length&&[[r.position().top,n]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},process:function(){var e=this.$scrollElement.scrollTop()+this.options.offset,t=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,n=t-this.$scrollElement.height(),r=this.offsets,i=this.targets,s=this.activeTarget,o;if(e>=n)return s!=(o=i.last()[0])&&this.activate(o);for(o=r.length;o--;)s!=i[o]&&e>=r[o]&&(!r[o+1]||e<=r[o+1])&&this.activate(i[o])},activate:function(t){var n,r;this.activeTarget=t,e(this.selector).parent(".active").removeClass("active"),r=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',n=e(r).parent("li").addClass("active"),n.parent(".dropdown-menu")&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate")}},e.fn.scrollspy=function(n){return this.each(function(){var r=e(this),i=r.data("scrollspy"),s=typeof n=="object"&&n;i||r.data("scrollspy",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.scrollspy.Constructor=t,e.fn.scrollspy.defaults={offset:10},e(function(){e('[data-spy="scroll"]').each(function(){var t=e(this);t.scrollspy(t.data())})})}(window.jQuery),!function(e){var t=function(t){this.element=e(t)};t.prototype={constructor:t,show:function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.attr("data-target"),i,s,o;r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("active"))return;i=n.find(".active a").last()[0],o=e.Event("show",{relatedTarget:i}),t.trigger(o);if(o.isDefaultPrevented())return;s=e(r),this.activate(t.parent("li"),n),this.activate(s,s.parent(),function(){t.trigger({type:"shown",relatedTarget:i})})},activate:function(t,n,r){function o(){i.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),s?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),r&&r()}var i=n.find("> .active"),s=r&&e.support.transition&&i.hasClass("fade");s?i.one(e.support.transition.end,o):o(),i.removeClass("in")}},e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("tab");i||r.data("tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e(function(){e("body").on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})})}(window.jQuery),!function(e){var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.$menu=e(this.options.menu).appendTo("body"),this.source=this.options.source,this.shown=!1,this.listen()};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(e)).change(),this.hide()},updater:function(e){return e},show:function(){var t=e.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});return this.$menu.css({top:t.top+t.height,left:t.left}),this.$menu.show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var n=this,r,i;return this.query=this.$element.val(),this.query?(r=e.grep(this.source,function(e){return n.matcher(e)}),r=this.sorter(r),r.length?this.render(r.slice(0,this.options.items)).show():this.shown?this.hide():this):this.shown?this.hide():this},matcher:function(e){return~e.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){var t=[],n=[],r=[],i;while(i=e.shift())i.toLowerCase().indexOf(this.query.toLowerCase())?~i.indexOf(this.query)?n.push(i):r.push(i):t.push(i);return t.concat(n,r)},highlighter:function(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},render:function(t){var n=this;return t=e(t).map(function(t,r){return t=e(n.options.item).attr("data-value",r),t.find("a").html(n.highlighter(r)),t[0]}),t.first().addClass("active"),this.$menu.html(t),this},next:function(t){var n=this.$menu.find(".active").removeClass("active"),r=n.next();r.length||(r=e(this.$menu.find("li")[0])),r.addClass("active")},prev:function(e){var t=this.$menu.find(".active").removeClass("active"),n=t.prev();n.length||(n=this.$menu.find("li").last()),n.addClass("active")},listen:function(){this.$element.on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this)),(e.browser.webkit||e.browser.msie)&&this.$element.on("keydown",e.proxy(this.keypress,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this))},keyup:function(e){switch(e.keyCode){case 40:case 38:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},keypress:function(e){if(!this.shown)return;switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:if(e.type!="keydown")break;e.preventDefault(),this.prev();break;case 40:if(e.type!="keydown")break;e.preventDefault(),this.next()}e.stopPropagation()},blur:function(e){var t=this;setTimeout(function(){t.hide()},150)},click:function(e){e.stopPropagation(),e.preventDefault(),this.select()},mouseenter:function(t){this.$menu.find(".active").removeClass("active"),e(t.currentTarget).addClass("active")}},e.fn.typeahead=function(n){return this.each(function(){var r=e(this),i=r.data("typeahead"),s=typeof n=="object"&&n;i||r.data("typeahead",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>'},e.fn.typeahead.Constructor=t,e(function(){e("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=e(this);if(n.data("typeahead"))return;t.preventDefault(),n.typeahead(n.data())})})}(window.jQuery),define("libs/bootstrap",[],function(){}),define("views/explorer/object/format",["Backbone","underscore","jQuery","libs/mustache","filereader","client/full","location","URL","views/json/viewer","libs/bootstrap"],function(e,t,n,r,i,s,o,u,a,f){var l=e.View.extend({className:"accordion-group",events:{"click .view":"click","click .download":"downloadClick"},template:r.compile('<div class="accordion-heading"><div class="view accordion-toggle" title="{{doc}}" data-view="{{format}}" data-toggle="collapse" data-target="#explorer-format-{{format}}" >Format: {{format}}<i class="icon-download download" /></div></div><div id="explorer-format-{{format}}" class="accordion-body collapse"><div class="accordion-inner"></div></div>'),initialize:function(e){this.path=e.path,this.format=e.format,this.doc=e.doc},render:function(){return this.$el.append(this.template(this)),this},click:function(){if(t.isUndefined(this.url))this.getFormat();else{if(this.url===null)return!1;if(!!this.displayable)return!0;this.download()}return!1},getFormat:function(){this.url=null,s.request({blob:!0,method:"GET",uri:this.path+"?format="+this.format,success:t.bind(this.gotFormat,this),fail:t.bind(this.failed,this)})},failed:function(){this.url=undefined},gotFormat:function(e,t,r){this.blob=e;var s=this.url=u.createObjectURL(e),o=this.$(".accordion-inner"),f,l=r.getResponseHeader("Content-type")||"",c=l.indexOf("text")===0||l==="application/xml";this.displayable=!0;if(l.indexOf("image")===0)n("<img />",{src:s,alt:t.uri}).appendTo(o);else if(l==="application/json")f=new i,f.onloadend=function(){var e=this.result;try{e=JSON.parse(this.result),o.append((new a({value:e})).render().el)}catch(t){n("<pre />").appendTo(o).text(this.result)}},f.readAsText(e);else if(c){var h=n("<pre />").appendTo(o);f=new i,f.onloadend=function(){h.text(this.result)},f.readAsText(e)}else this.download(),this.displayable=!1;this.displayable&&this.$(".accordion-body").collapse("show"),this.trigger("gotFormat",s,e)},downloadClick:function(){return this.url?this.download():(this.bind("gotFormat",this.download,this),t.isUndefined(this.url)&&this.getFormat()),!1},download:function(){o.set(this.url)}});return l}),define("keyevent",{DOM_VK_CANCEL:3,DOM_VK_HELP:6,DOM_VK_BACK_SPACE:8,DOM_VK_TAB:9,DOM_VK_CLEAR:12,DOM_VK_RETURN:13,DOM_VK_ENTER:14,DOM_VK_SHIFT:16,DOM_VK_CONTROL:17,DOM_VK_ALT:18,DOM_VK_PAUSE:19,DOM_VK_CAPS_LOCK:20,DOM_VK_ESCAPE:27,DOM_VK_SPACE:32,DOM_VK_PAGE_UP:33,DOM_VK_PAGE_DOWN:34,DOM_VK_END:35,DOM_VK_HOME:36,DOM_VK_LEFT:37,DOM_VK_UP:38,DOM_VK_RIGHT:39,DOM_VK_DOWN:40,DOM_VK_PRINTSCREEN:44,DOM_VK_INSERT:45,DOM_VK_DELETE:46,DOM_VK_0:48,DOM_VK_1:49,DOM_VK_2:50,DOM_VK_3:51,DOM_VK_4:52,DOM_VK_5:53,DOM_VK_6:54,DOM_VK_7:55,DOM_VK_8:56,DOM_VK_9:57,DOM_VK_SEMICOLON:59,DOM_VK_EQUALS:61,DOM_VK_A:65,DOM_VK_B:66,DOM_VK_C:67,DOM_VK_D:68,DOM_VK_E:69,DOM_VK_F:70,DOM_VK_G:71,DOM_VK_H:72,DOM_VK_I:73,DOM_VK_J:74,DOM_VK_K:75,DOM_VK_L:76,DOM_VK_M:77,DOM_VK_N:78,DOM_VK_O:79,DOM_VK_P:80,DOM_VK_Q:81,DOM_VK_R:82,DOM_VK_S:83,DOM_VK_T:84,DOM_VK_U:85,DOM_VK_V:86,DOM_VK_W:87,DOM_VK_X:88,DOM_VK_Y:89,DOM_VK_Z:90,DOM_VK_CONTEXT_MENU:93,DOM_VK_NUMPAD0:96,DOM_VK_NUMPAD1:97,DOM_VK_NUMPAD2:98,DOM_VK_NUMPAD3:99,DOM_VK_NUMPAD4:100,DOM_VK_NUMPAD5:101,DOM_VK_NUMPAD6:102,DOM_VK_NUMPAD7:103,DOM_VK_NUMPAD8:104,DOM_VK_NUMPAD9:105,DOM_VK_MULTIPLY:106,DOM_VK_ADD:107,DOM_VK_SEPARATOR:108,DOM_VK_SUBTRACT:109,DOM_VK_DECIMAL:110,DOM_VK_DIVIDE:111,DOM_VK_F1:112,DOM_VK_F2:113,DOM_VK_F3:114,DOM_VK_F4:115,DOM_VK_F5:116,DOM_VK_F6:117,DOM_VK_F7:118,DOM_VK_F8:119,DOM_VK_F9:120,DOM_VK_F10:121,DOM_VK_F11:122,DOM_VK_F12:123,DOM_VK_F13:124,DOM_VK_F14:125,DOM_VK_F15:126,DOM_VK_F16:127,DOM_VK_F17:128,DOM_VK_F18:129,DOM_VK_F19:130,DOM_VK_F20:131,DOM_VK_F21:132,DOM_VK_F22:133,DOM_VK_F23:134,DOM_VK_F24:135,DOM_VK_NUM_LOCK:144,DOM_VK_SCROLL_LOCK:145,DOM_VK_COMMA:188,DOM_VK_PERIOD:190,DOM_VK_SLASH:191,DOM_VK_BACK_QUOTE:192,DOM_VK_OPEN_BRACKET:219,DOM_VK_BACK_SLASH:220,DOM_VK_CLOSE_BRACKET:221,DOM_VK_QUOTE:222,DOM_VK_META:224}),define("views/json/scalar",["Backbone","underscore","keyevent"],function(e,t,n){var r=e.View.extend({tagName:"em",dataType:"null",initialize:function(e){this.originalValue=e.originalValue},render:function(){return this.$el.text("null"),this},getValue:function(){return null}},{detect:t.isNull}),i=e.View.extend({tagName:"input",complex:!1,dataType:"boolean",attributes:{tabindex:1},initialize:function(e){this.originalValue=e.originalValue,this.$el.prop("checked",e.value).prop("type","checkbox")},getValue:function(){return this.$el.prop("checked")}},{detect:t.isBoolean}),s=e.View.extend({complex:!1,initialize:function(e){this.originalValue=e.originalValue},attributes:{tabindex:1},_choose:function(e,n){var r=this._score(e),i=this._score(n);return!r&&!i?"":(e=r>=i?e:n,Math.max(r,i)>.25?e:t.first(e))},_score:function(e){return t.isString(e)?1:t.isNumber(e)?.75:t.isNull(e)||t.isBoolean(e)||t.isEmpty(e)?0:t.isArray(e)?.25:.25}}),o=s.extend({tagName:"textarea",dataType:"string",attributes:{rows:1,tabindex:1},events:{keypress:"onKeyPress",blur:"triggerChange"},initialize:function(e){o.__super__.initialize(e),this.$el.text(this._choose(e.value,e.originalValue)),this._setRows()},_setRows:function(){this.$el.attr("rows",this.getValue().split("\n").length)},onKeyPress:function(e){e.keyCode===n.DOM_VK_RETURN&&this._setRows()},triggerChange:function(){this.trigger("change")},getValue:function(){return this.$el.prop("value")}},{detect:t.isString}),u=s.extend({attributes:{type:"number",tabindex:1},tagName:"input",dataType:"number",initialize:function(e){u.__super__.initialize(e),this.$el.prop("value",this._choose(e.value,e.originalValue))},getValue:function(){return Number(this.$el.prop("value"))||0},_score:function(e){return t.isNumber(e)?1:t.isString(e)?.5:0}},{detect:t.isNumber});return{number:u,string:o,"null":r,"boolean":i}}),define("views/json/object",["Backbone","jQuery","keyevent","libs/mustache"],function(e,t,n,r){var i=e.View.extend({tagName:"span",className:"label label-inverse",events:{dblclick:"edit","blur input":"show",keypress:"onKeyPress"},initialize:function(e){this.key=e,this.editing=!1},onKeyPress:function(e){return e.keyCode===n.DOM_VK_RETURN?(this.show(),!1):!0},show:function(){return this.editing&&(this.editing=!1,this.key=this.$("input").attr("value"),this.$el.text(this.key)),!0},edit:function(){return this.editing||(this.editing=!0,t("<input />",{tabindex:"1",type:"text",value:this.key}).appendTo(this.$el.empty()).focus()),!1},render:function(){return this.$el.text(this.key),this.key===""?this.edit():this.show(),this},getValue:function(){return this.key}}),s=e.View.extend({tagName:"dd",initialize:function(e,t){this.key=e,this.valueView=t,this.valueView.bind("pop",this.repop,this)},repop:function(){this.trigger("pop",this)},template:r.compile('<dl> <span class="label label-info">{{ key }}</span>: </dl><dt> </dt>'),render:function(){return this.$el.append(this.template({key:this.key})),this.$("dt").append(this.valueView.render().el),this},getKey:function(){return this.key},getValue:function(){return[this.getKey(),this.valueView.getValue()]}}),o=s.extend({className:"okev",initialize:function(e,t){this.keyView=new i(e),this.valueView=t,this.valueView.bind("pop",this.repop,this)},render:function(){return this.$el.append(this.keyView.render().el).append(t("<dt />").append(this.valueView.render().el)),this},getKey:function(){return this.keyView.getValue()}});return{fixed:s,edit:o}}),define("views/json/composed",["Backbone","underscore","jQuery","libs/mustache","views/json/object","underscore-extensions"],function(e,t,n,r,i,s){var o=e.View.extend({tagName:"span",className:"label",events:{click:"reenable"},reenable:function(){this.trigger("reenable",this,this.view)},initialize:function(e){this.view=e.view},render:function(){return this.$el.text(this.view.getKey()),this}}),u=e.View.extend({complex:!0,initialize:function(e){this.finder=e.finder,this.originalValue=e.originalValue;var n=this._choose(e.value,e.originalValue),r,i;t.isArray(e.types)||t.isObject(e.types)?(r=e.types,i=t.keys(r)):(r={},i=t.keys(n)),this.valueViews=t.map(i,function(e){var t=this.makeView(n[e],e,r[e]);return t.bind("pop",this.removeKey,this),t},this),this.disabledViews=[]},getValue:function(){return t.chain(this.valueViews).difference(this.disabledViews).map(function(e){return e.getValue()}).value()},_choose:function(e,n){var r=this._score(e),i=this._score(n);return!r&&!i?[]:(e=r>=i?e:n,Math.max(r,i)===.25?this.arrayBias?[e]:{"":e}:this.arrayBias&&!t.isArray(e)?t.values(e):e)},render:function(){return t.each(this.valueViews,function(e){n("<li />").append(e.render().el).appendTo(this.el)},this),this},removeKey:function(e){this.disabledViews.push(e);var t=new o({view:e});return t.render().$el.insertBefore(e.el),e.$el.detach(),t.bind("reenable",this.addKey),t},addKey:function(e,n){this.disabledViews=t.without(e,n),e.$el.replaceWith(n.$el),e.unbind()},_score:function(e){return t.isNull(e)||t.isBoolean(e)||t.isUndefined(e)?0:t.isNumber(e)||t.isString(e)?.25:t.isArray(e)?.75+this.arrayBias*.25:1-this.arrayBias*.25}}),a=u.extend({addTextTemplate:r.compile('<li class="add-item" ><button tabindex="1" class="btn btn-mini">{{ . }}</button></li>'),events:{"click .add-item":"addItem"},render:function(){return a.__super__.render.call(this),this.$el.append(this.addTextTemplate(this.addText)),this},removeKey:function(e){n(e.el).parent(this.$el.children("li")).remove(),this.valueViews=t.without(this.valueViews,e)},addItem:function(){var e=this.makeEmptyItem();return e.bind("pop",this.removeKey,this),this.valueViews.push(e),n("<li />").append(e.render().el).insertBefore(this.$el.children(".add-item")).find(":input").not(".btn").first().focus(),!1}},{make:function(e,n,r){return n=t.extend({},e,n),{FixedView:u.extend(e,{detect:r}),EditView:a.extend(n,{detect:r})}}}),f=a.make({tagName:"ol",dataType:"array",arrayBias:1,makeView:function(e,t,n){return this.finder.getView(e,n)}},{addText:"Add a row",makeEmptyItem:function(){return this.finder.getView("")}},t.isArray),l=a.make({tagName:"ul",dataType:"object",arrayBias:0,ItemView:i.fixed,makeView:function(e,t,n){return new this.ItemView(t,this.finder.getView(e,n))},getValue:function(){return t.objectify(a.prototype.getValue.call(this))}},{addText:"Add a key",ItemView:i.edit,makeEmptyItem:function(){return new this.ItemView("",this.finder.getView(""))}},t.isObject);return{fixed:{object:l.FixedView,array:f.FixedView},edit:{object:l.EditView,array:f.EditView}}}),define("views/json/edit",["Backbone","underscore","jQuery","libs/mustache","views/json/viewer","underscore-extensions"],function(e,t,n,r,i,s){var o=e.View.extend({tagName:"textarea",className:"text-edit",initialize:function(e){this.finder=e.finder,this.value=e.value,this.types=e.types},render:function(){return this.$el.attr("value",JSON.stringify(this.value,null,4)),this},getValue:function(){var e=this._getValue();return this._check(e,this.types)},_check:function(e,n){return t.isString(n)&&this._checkSimple(e,n)?e:t.isObject(n)?this._checkObject(e,n):t.isArray(n)?this._checkArray(e,n):""},_checkObject:function(e,n){return t.isObject(e)?(e=t.chain(n).map(function(t,n){return n in e?[n,this._check(e[n],t)]:[n,""]},this).compact().objectify(),e):{}},_checkArray:function(e,t){return e},_checkSimple:function(e,t){return this.finder.getViewClassByType(t).detect(e)},_getValue:function(){try{return JSON.parse(this.el.value)}catch(e){return null}}}),u=i.extend({className:"json-edit json",finder:null,initialize:function(e){this.value=e.value,this.types=e.types,this.withCancel=t.isUndefined(e.withCancel)?!1:!!e.withCancel,this.view=null,this.shown=""},getValue:function(){return this.view.getValue()},showText:function(){if(this.shown==="text")return;this.shown="text",this.updateValue(),this.view=new o({value:this.value,types:this.types,finder:this.finder}),this.updateView()},showBuilder:function(){if(this.shown==="builder")return;this.shown="builder",this.updateValue(),this.view=this.finder.getView(this.value,this.types),this.updateView()},updateValue:function(){this.value=this.view?this.view.getValue():this.value},updateView:function(){this.$(".json-edit-body").empty().append(this.view.render().el)},template:r.compile('<div class="json-edit-header btn-group" data-toggle="buttons-radio" ><button class="btn text">Text</button><button class="btn builder active" >Builder</button></div><div class="json-edit-body"> </div><div class="btn-group" ><button tabindex="2" class="btn btn-primary validate" >Validate</button>{{#withCancel}}<button tabindex="2" class="btn btn-danger cancel" >Cancel</button>{{/withCancel}}</div>'),events:{"click .text":"showText","click .builder":"showBuilder","click .validate":"validate","click .cancel":"cancel"},render:function(){return this.$el.append(this.template({withCancel:this.withCancel})),this.showBuilder(),this},validate:function(){this.trigger("validate",this.getValue())},cancel:function(){this.trigger("cancel")}});return{text:o,builder:u}}),define("views/json/editor",["Backbone","underscore","jQuery","views/json/finder","views/json/scalar","views/json/composed","views/json/edit","underscore-extensions"],function(e,t,n,r,i,s,o){var u=o.builder.extend({finder:new r.editor({views:t.flatten([t.values(i),t.values(s.edit)]),fixedViews:t.values(s.fixed),typesMap:{"default":"string",list:"array",dict:"object",str:"string",unicode:"string",set:"array","int":"number"}})});return u}),define("views/explorer/object/gettype",["underscore","underscore-extensions"],function(e,t){return function(t){return e.chain(t).map(function(e,t){var n=e.type;return e.computed?!1:(e.optional&&(n+=";optional"),[t,n])}).compact().objectify().value()}}),define("views/explorer/object/edit",["Backbone","underscore","client/full","views/json/editor","views/explorer/object/gettype"],function(e,t,n,r,i){var s=e.View.extend({className:"object-edit",initialize:function(e){this.path=e.path,this.editView=new r({withCancel:!0,value:e.object,types:i(e.metaData.resource_fields)}),this.editView.bind("cancel",this.cancel,this).bind("validate",this.sendPUT,this),this.trigger("gotEditView",this.editView)},cancel:function(){this.trigger("cancel")},render:function(){return this.$el.append(this.editView.render().el),this.$(":input").not(".btn").first().focus(),this},sendPUT:function(e){n.PUT(this.path,e,function(e,t,n){this.trigger("updated",this.path,t,n)}.bind(this))}});return s}),define("views/explorer/action",["Backbone","underscore","jQuery","libs/mustache","client/full","views/json/viewer","views/json/editor"],function(e,t,n,r,i,s,o){var u=e.View.extend({className:"alert alert-info",initialize:function(e,t){this.path=e,this.action=t,this.actionUrl=this.path+"/_napix_action/"+this.action,this.optionalView=null,this.mandatoryView=null},events:{"click .validate":"validate","click .ok":"clear"},render:function(){return this.getActionMetaData(),this.$el.empty().append(this.templateLoad(this)),this},templateLoad:r.compile('<a href="#" class="close" data-dismiss="alert" >X</a><h3>{{ path}} - {{ action }}</h3>'),template:r.compile('<div class="content json"><p>{{ doc }}</p>{{#mandatory}}<h4>Mandatory parameters</h4><div id="mandatory"></div>{{/mandatory}}{{#optional}}<h4>Optionnal parameters</h4><div id="optional"></div>{{/optional}}<button class="btn btn-primary validate">Validate</button></div>'),getActionMetaData:function(){i.GET(this.actionUrl+"/_napix_help",this.gotActionMetaData.bind(this))},gotActionMetaData:function(e){var r=t.reduce(e.mandatory,function(e,t){return e[t]="",e},{}),i=n(this.template(e));t.isEmpty(r)||(this.mandatoryView=new o({value:r}),i.find("#mandatory").replaceWith(this.mandatoryView.render().el)),t.isEmpty(e.optional)||(this.optionalView=new o({value:e.optional}),i.find("#optional").replaceWith(this.optionalView.render().el)),this.$el.append(i),this.$(":input,button.validate").first().focus()},validate:function(){i.POST(this.actionUrl,this.getValue(),this.gotResult.bind(this))},gotResult:function(e){this.$(".content").empty().append((new s({value:e})).render().el).append('<button class="btn ok" >Ok</button>')},clear:function(){return this.$el.alert("close"),!1},getValue:function(){return t.extend(this.mandatoryView?this.mandatoryView.getValue():{},this.optionalView?this.optionalView.getValue():{})}});return u}),define("views/explorer/object/view",["Backbone","underscore","libs/mustache","client/full","views/json/viewer","views/explorer/object/format","views/explorer/object/edit","views/explorer/action"],function(e,t,n,r,i,s,o,u){var a=e.View.extend({id:"explorer-object",className:"tab-pane",events:{"click .delete":"sendDELETE","click .action":"callAction","click .edit":"edit"},template:n.compile('<div class="object-show"><div class="accordion-heading"><a data-toggle="collapse" data-target="#explorer-raw-json" >Raw JSON data</a></div><div id="explorer-raw-json" class="accordion-body collapse"><div class="accordion-inner"><pre>{{raw}}</pre></div></div><div id="explorer-object-actions" class="btn-group" >{{#deletable}}<button class="btn btn-danger delete" >Delete</button>{{/deletable}}{{#editable}}<button class="btn edit" >Edit</button>{{/editable}}{{#actions}}<button class="btn action" title="{{val}}"  data-action="{{key}}" >{{key}}</button>{{/actions}}</div></div>'),initialize:function(e){var n=this.view=e.view;return this.value=e.view.content,this.path=e.view.path,this.insideView=new i({value:this.value}),this.actions=n.parentMetaData?n.parentMetaData.actions:{},this.formatViews=t.map(n.parentMetaData&&n.parentMetaData.views,function(e,t){return new s({format:t,doc:e,path:this.path})},this),this.editable=!!n.parentMetaData&&!!t.contains(n.parentMetaData.resource_methods,"PUT"),this.deletable=!!n.parentMetaData&&!!t.contains(n.parentMetaData.resource_methods,"DELETE"),this},render:function(){return this.$el.append(this.template({deletable:this.deletable,editable:this.editable,actions:t.items(this.actions),raw:JSON.stringify(this.value,undefined,1)})),this.$(".object-show").prepend(this.insideView.render().el),t.each(this.formatViews,function(e){this.$el.append(e.render().el)},this),this},callAction:function(e){var t=e.target.data.action;return(new u(this.path,t)).render().$el.prependTo(this.el),!1},sendDELETE:function(){r.DELETE(this.path,function(e,t,n){this.trigger("deleted",this.path)}.bind(this))},fireUpdate:function(){this.view.refreshObject(),this.editing=!0,this.edit(),delete this.editing},edit:function(){if(t.isUndefined(this.editing)){this.editing=!0;var e=new o({object:this.value,meta:this.view.parentMetaData,path:this.view.path});this.$(".object-show").hide(),e.on("updated",this.fireUpdate,this).on("cancel",this.edit,this).render().$el.prependTo(this.el)}else this.editing?(this.$(".object-edit").hide(),this.$(".object-show").show(),this.editing=!1):(this.$(".object-show").hide(),this.$(".object-edit").show(),this.editing=!0);return!1}});return a}),define("views/explorer/object/meta",["Backbone","deferred","views/json/viewer"],function(e,t,n){var r=e.View.extend({template:'<div class="accordion-heading"><a data-toggle="collapse" data-target="#explorer-raw-json" >Raw JSON data</a></div><div id="explorer-raw-json" class="accordion-body collapse"><div class="accordion-inner"><pre></pre></div></div>',id:"explorer-help",className:"tab-pane",initialize:function(e){this.view=e.view,this.insideView=new t,e.view.metaData.always(function(t){this.value=t||e.view.parentMetaData,this.insideView.resolve(new n({value:this.value}))}.bind(this))},render:function(){return this.$el.append(this.template),this.insideView.done(function(e){this.$el.prepend(e.render().el).find("pre").text(JSON.stringify(this.value,undefined,1))}.bind(this)),this}});return r}),define("views/explorer/object/create",["Backbone","underscore","libs/deferred","client/full","views/json/editor","views/explorer/object/gettype"],function(e,t,n,r,i,s){var o=e.View.extend({className:"tab-pane",id:"explorer-create",initialize:function(e){this.view=e.view,this.path=e.view.path,this.inside=(new n(function(i){return n.when(e.view.metaData.pipe(t.identity),r.getNewObject(e.view.path).pipe(t.identity)).then(i.resolve.bind(i),i.reject.bind(i))})).done(function(e,t){this.editView=new i({withCancel:!1,value:t,types:s(e.resource_fields)}),this.editView.bind("validate",this.sendPOST,this)}.bind(this))},render:function(){return this.inside.done(function(){this.$el.empty().append(this.editView.render().el),this.$(":input").not(".btn").first().focus()}.bind(this)).fire(),this},sendPOST:function(e){r.POST(this.path+"/",e,function(e,t,n){this.view.refreshList(),this.trigger("created",this.path,t,n)}.bind(this))}});return o}),define("views/explorer/explorer",["Backbone","underscore","jQuery","client/full","views/explorer/root","views/explorer/alert","views/explorer/object/view","views/explorer/object/meta","views/explorer/object/create","deferred","libs/bootstrap"],function(e,t,n,r,i,s,o,u,a,f,l){var c=e.View.extend({events:{"click .refresh":"refreshObject"},initialize:function(){this.setElement(n("#explorer")),r.bind("change",this.selectServer,this),this.currentView=null,this.rootView=new f,this.alert_=new s,r.bind("error",this.alert_.failed,this.alert_)},showObject:function(){this.$("#explorer-object-label").tab("show"),this.$("#explorer-object").addClass("active")},goToPath:function(e,t){return t=t||new f,this.rootView.done(function(n){n.goToPath(e,t)}).fail(function(){this.goToPath(e,t)}.bind(this)),t},selectServer:function(e){n("#server").text(e.getConnectionString()),this.rootView.state()==="resolved"&&(this.rootView=new f);var t=new i;t.bind("select",this.select,this),n("#explorer-server").empty().append(t.render().el),t.deploy(),t.list.then(function(){this.rootView.resolve(t)}.bind(this),function(){var e=this.rootView;this.rootView=new f,e.reject()}.bind(this)).always(this.clean.bind(this))},clean:function(){this.$("#explorer-view").empty(),this.currentView=null,this.object&&(this.object.unbind(),delete this.object),this.create&&(this.create.unbind(),delete this.create)},select:function(e){this.currentView!==null&&this.currentView.setSelected(!1),this.clean(),this.currentView=e,e.setSelected(!0);var n=new u({view:e});this.object=new o({view:e}),this.object.bind("deleted",this.deleted,this),this.$("#explorer-view").append(this.object.render().el).append(n.render().el),e.metaData.state()!=="resolved"&&this.$("#explorer-create-label").hide(),e.metaData.done(function(n){var r=n&&t.contains(n.collection_methods,"POST");r?(this.create=(new a({view:e})).bind("created",this.created,this),this.create.$el.appendTo(this.$("#explorer-view")),this.$("#explorer-create-label").show().on("show",this.create.render.bind(this.create))):this.$("#explorer-create-label").hide()}.bind(this)),this.showObject(),this.trigger("selected",e.path)},refreshObject:function(){return this.currentView&&(this.currentView.refreshObject(),this.currentView.refreshList()),!1},created:function(e,t,n){this.alert_.done("Created",t,n),this.showObject()},deleted:function(e,t,n){var r=e.split("/").slice(0,-1).join("/");this.goToPath(r).done(function(e){e.refreshList(),e.select()}),this.alert_.done("Deleted",t,n)}});return c}),define("views/selectors",["Backbone","underscore","jQuery","models/servers","models/credentials","libs/mustache","client/full","keyevent","location"],function(e,t,n,r,i,s,o,u,a){var f=e.View.extend({tagName:"li",template:s.compile('<a href="#">{{.}}</a><i class="icon-remove pull-right"/>'),events:{"click a":"select","click .remove":"destroy"},initialize:function(){this.model.bind("change:selected",this.setSelected,this),this.model.bind("destroy",this.remove,this)},select:function(){return this.model.select(),!1},destroy:function(){return this.model.destroy(),!1},render:function(){return this.$el.append(this.template(this.model.toString())),this.setSelected(),this},setSelected:function(){this.$el.toggleClass("selected",this.model.get("selected"))},remove:function(){this.$el.remove()}}),l=e.View.extend({ItemView:f,events:{"click .add":"showPrompt","click .plus":"showPrompt","keypress .prompt input":"updateOnEnter","click .prompt .go":"addItem","click .prompt .cancel":"launchFinished"},className:"well",template:s.compile('<ul class="body"></ul><div class="controls btn-group"><button class="btn add plus" >Ajouter</button></div><div class="prompt">{{#inputs}}<label>{{label}}<input type="text" name="{{ name }}" /></label>{{/inputs}}<div class="btn-group"><button class="btn btn-primary go" >Ajouter</button><button class="btn btn-danger cancel" >Cancel</button></div></div>'),initialize:function(){this.collection.bind("reset",this.addAll,this),this.collection.bind("reset",this.ensureDefault,this),this.collection.bind("add",this.addOne,this),this.bind("finished",this.hidePrompt,this)},render:function(){return this.$el.append(this.template({inputs:this.inputs})),this.hidePrompt(),this.collection.fetch(),this},launchFinished:function(){this.trigger("finished")},addAll:function(){this.collection.each(this.addOne,this)},addOne:function(e){this.$(".body").append((new this.ItemView({model:e})).render().el)},hidePrompt:function(){this.$(".prompt").hide(),this.$(".controls").show()},showPrompt:function(){this.$(".prompt").show().find(":input").attr("value","").first().focus(),this.$(".controls").hide()},updateOnEnter:function(e){e.keyCode===u.DOM_VK_RETURN?this.addItem():e.keyCode===u.DOM_VK_ESCAPE&&this.trigger("finished")},addItem:function(){var e=t(this.$("input").toArray()).chain().map(function(e){return n(e)}).map(function(e){return[e.prop("name"),e.prop("value")]}).objectify().value(),r=this.collection.create(e);r&&(this.trigger("finished"),r.select())}}),c=l.extend({collection:r,prefix:"connections-servers",events:t.extend({"click .reload":"refresh"},l.prototype.events),inputs:[{label:"Host",name:"host"}],render:function(){return c.__super__.render.call(this),n('<button class="btn reload"><i class="icon-refresh" ></i></button>').tooltip({title:"Reload the server",placement:"bottom"}).appendTo(this.$(".controls")),this},refresh:function(e){if(n(e.target).hasClass("disabled"))return;o.GET("/_napix_reload",this.reEnable.bind(this)),this.$(".reload").addClass("disabled")},reEnable:function(){this.$(".reload").removeClass("disabled")},ensureDefault:function(){this.collection.where({host:a.get().host}).length===0&&this.collection.create({host:a.get().host})}}),h=l.extend({collection:i,prefix:"connections-credentials",inputs:[{label:"Login",name:"login"},{label:"Password",name:"pass"}],events:t.extend({"click .anon":"makeAnonAuth"},l.prototype.events),hasAnonAuth:function(){return this.collection.where({pass:"_napix_noauth"}).length!==0},makeAnonAuth:function(){this.hasAnonAuth()||this.collection.create({login:"No auth (debug)",pass:"_napix_noauth"}),this.hidePrompt()},render:function(){return h.__super__.render.call(this),this.hasAnonAuth()||n('<button class="btn anon">Anon</button>').popover({title:"Authentification anonyme",content:"Quand le serveur est en mode debug, L'authentification est optionelle",placement:"top",trigger:"hover",delay:400}).appendTo(this.$(".prompt .btn-group")),this},ensureDefault:function(){this.collection.length===0&&this.showPrompt()}}),p=e.View.extend({initialize:function(){this.setElement("#connections"),this.serverSelector=new c,this.loginSelector=new h},render:function(){return this.$el.append(this.serverSelector.render().el).append(this.loginSelector.render().el),this}});return p}),define("models/servers",["Backbone"],function(e){var t=e.Model.extend({select:function(){},sync:function(){},toString:function(){return this.get("host")}}),n=e.Collection.extend({model:t,fetch:function(){return this},sync:function(){},where:function(){return[1]}});return new n}),define("models/credentials",["Backbone","underscore"],function(e,t){var n={fetch:function(){return this},where:function(){return[1]}};return t.extend(n,e.Events),n}),define("client/full",["Backbone","underscore","deferred"],function(e,t,n){var r={getConnectionString:function(){return"FirstRun mode"},requests:{},getNewObject:function(e,t){return this.request({method:"GET",uri:e+"/_napix_new"}).done(t)},getLevel:function(e,t){return this.request({method:"GET",uri:e+"/_napix_help"}).done(t)},GET:function(e,t,n){return this._request("GET",e,null,t,n)},HEAD:function(e,t,n){return this._request("HEAD",e,null,t,n)},PUT:function(e,t,n,r){return this._request("PUT",e,t,n,r)},POST:function(e,t,n,r){return this._request("POST",e,t,n,r)},DELETE:function(e,t,n){return this._request("DELETE",e,null,t,n)},_request:function(e,t,n,r,i){var s={method:e,uri:t,data:n};return this.request(s).then(r,i)},request:function(e){var t=new n,r=e.method+" "+e.uri;return this.requests[r]=t,t.always(function(){delete this.requests[r]}.bind(this)),t.promise()}};return t.extend(r,e.Events),r}),define("views/firstrun",["Backbone","underscore","jQuery","views/explorer/explorer","views/selectors","libs/bootstrap","client/full","models/servers","models/credentials","location"],function(e,t,n,r,i,s,o,u,a,f){var l=e.Router.extend({initialize:function(){this.controls=(new c).render(),this.explorer=(new r).render(),this.selectors=(new i).render(),this.currentStep=0,this.controls.on("next",this.nextStep,this),this.controls.on("previous",this.previousStep,this),this.states=new h({app:this}),o.trigger("change",o)},routes:{"":"defaultRoute","step/:step":"goToStep"},nextStep:function(){this.goToStep(this.currentStep+1)},previousStep:function(){if(this.currentStep===1)return;this.goToStep(this.currentStep-1)},defaultRoute:function(){this.goToStep(1)},goToStep:function(e){var n=this.states["state"+e];if(!n)return;this.navigate("step/"+e),this.currentStep=+e,t.defer(t.bind(n,this.states,this))}}),c=e.View.extend({events:{"click .next":"next","click .previous":"previous"},initialize:function(){this.setElement("#firstrun-tab")},next:function(){return this.trigger("next"),!1},previous:function(){return this.trigger("previous"),!1},render:function(){return this.$("#firstrun").addClass("active"),this.$el.append('<li><a href="#"><i class="icon-arrow-left previous icon-white" /></a></li><li><a href="#"><i class="icon-arrow-right next icon-white" /></a></li><li><a href="."><i class="icon-stop stop icon-white" /></a></li>'),this}}),h=e.View.extend({initialize:function(e){this.length="?",u.create({host:f.get().host}),this.app=e.app},popover:function(e,t){t.trigger=t.trigger||"manual",this._popover&&this._popover.popover("hide"),this._popover=n(e).popover(t).popover("show")},state1:function(){this.popover("#firstrun",{title:"Quick tour",content:"Take a quick tour of the feature that this web interface provides. Use the the arrows to navigate throught the tooltips",placement:"bottom"})},state2:function(e){this.popover(e.selectors.serverSelector.el,{title:"Servers",content:"You can connect to any Napix server.By default, you are connected to the serveryou are surfing on.",placement:"left"})},state3:function(e){e.selectors.serverSelector.showPrompt(),this.popover(e.selectors.serverSelector.el,{title:"Add a server",content:"just type the url of the server",placement:"left"}),t.delay(function(){e.selectors.serverSelector.$('input[name="host"]').val("this.napix.nx")},500),t.delay(function(){e.selectors.serverSelector.addItem()},500)},state4:function(e){this.popover(e.selectors.serverSelector.$(".icon-remove:eq(1)"),{title:"Remove the server",content:"This button removes the server from the list",placement:"bottom"})},state5:function(e){this.popover(e.selectors.serverSelector.$("li:first"),{title:"Select the server",content:"Click on the server address to choose it",placement:"left"})},state6:function(e){e.selectors.loginSelector.showPrompt(),this.popover(e.selectors.loginSelector.el,{title:"Same thing for the credentials",content:"If napix is in DEBUG mode, the Anon button wil let you connect without a login",placement:"left"})},withSample:function(){this.hasSample||(this.hasSample=!0,o.requests["GET /"].resolve(["/sample"]),o.requests["GET /sample/_napix_help"].resolve({direct_plug:null,collection_methods:["POST"],resource_methods:["PUT","GET","DELETE"],resource_fields:{foo:{type:"string"},mpm:{type:"string"},baz:{type:"array"}}}))},state7:function(){this.withSample(),this.popover("#explorer-root",{title:"Server root",content:"This is the root of the server.You can browse the objects and the managers",placement:"bottom"})},withSampleList:function(){this.withSample(),this.hasSampleList||(this.hasSampleList=!0,this.app.explorer.goToPath("/sample").done(function(e){e.toggleList(!0)}),o.requests["GET /sample/"].resolve(["/sample/first","/sample/second"]))},state8:function(){this.withSample(),this.popover("#explorer-root .path:first",{title:"Explore the manager",content:"Click on the plus in order to deploy the content of the manager",placement:"right"}),this.withSampleList()},withSampleObject:function(){this.withSampleList(),this.hasSampleObject||(this.hasSampleObject=!0,this.app.explorer.goToPath("/sample/first").done(function(){o.requests["GET /sample/first"].resolve({mpm:"prefork",foo:"bar",baz:[4,8,15,16,23,42]})}))},state9:function(){this.withSampleList(),this.popover('#explorer-root .path:contains("/sample/first")',{title:"Get an object",content:"Click on the object path to get its content in the object tab",placement:"right"}),this.withSampleObject()},state10:function(e){this.withSampleObject(),e.explorer.showObject(),this.popover("#explorer-object-label",{title:"Object Tab",content:"In this tab you can view the data of the selected object",placement:"bottom"})},state11:function(e){this.withSampleObject(),e.explorer.showHelp(),this.popover("#explorer-object-label",{title:"Help Tab",content:"In this tab you can view the metadata of the selected managerThose metadata are generated by the class from the Napix modules",placement:"bottom"})},withCreate:function(){this.hasCreate||(this.hasCreate=!0,this.withSampleObject(),this.app.explorer.goToPath("/sample").done(function(){this.app.explorer.showCreate(),o.requests["GET /sample/_napix_new"].resolve({foo:"bar",mpm:"worker",baz:[1,1,2,3,5]})}.bind(this)))},state12:function(){this.withCreate(),this.popover("#explorer-create-label",{title:"Create Tab",content:"In this tab you can createa new object of the selected manager",placement:"bottom"})},state13:function(){this.withCreate(),this.popover("#explorer-create",{title:"Editor",content:"You can use this editor to create the object you'll send",placement:"left"})},state14:function(){this.withCreate(),this.popover("#explorer-create .json-mte:eq(3)",{placement:"right",title:"Type switcher",content:"Use this little toolbar to change the type of JSON data you want to send The red X at the end deletes the entry. If the type is not changeable, it just shows the type"})},state15:function(){this.withCreate(),this.popover('#explorer-create button:contains("Validate")',{title:"Validate button",content:"Send the result"})},state16:function(){this.withSampleList(),this.app.explorer.create.trigger("validate","/sample",{}),this.app.explorer.refreshObject(),o.requests["GET /sample/"].resolve(["/sample/first","/sample/second","/sample/third"]),this.popover('#explorer-root .path:contains("/sample/third")',{title:"Created resource",content:"The resource is created and got its own address"})},state17:function(){this.withSampleObject(),this.popover('#explorer-object button[data-event="edit"]',{title:"Modify the object",content:"Click on this button to edit the object",placement:"top"})},withEditObject:function(){this.hasEditObject||(this.hasEditObject=!0,this.withSampleObject(),this.app.explorer.showEdit())},state18:function(){this.withEditObject(),this.popover(".json-edit",{title:"Edit the object",content:"The same editor as the creation view"})},state19:function(){this.withSampleObject(),this.app.explorer.showObject(),o.trigger("error","Something has failed for a reason or another",{data:{foo:"MyBar",mpm:"worker",baz:[1,2,3,4,5]},method:"PUT",uri:"/sample/third"},{status:409,statusText:"Conflict",getAllResponseHeaders:function(){return"Server: bottle\nDate: 2012-04-12\n"}}),this.popover(".alert",{title:"When an error is encountered",content:"It pops when a request does not succeed It shows the kind of error and the associated text You may click the retry button to resubmit the request"})},state20:function(){this.withSampleObject(),n(".alert").alert("close"),this.popover('#explorer-object button[data-event="delete"]',{title:"Delete button",content:"Deletes the current object"})},state21:function(){this.popover(".stop",{title:"End",content:"This discovery assistant has finished. Click here to use the real web interface",placement:"bottom"})}});return l})